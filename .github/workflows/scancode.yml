name: ScanCode License Scan
on: [workflow_dispatch]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Run ScanCode Analysis
        uses: nexb/scancode-action@main
        with:
          # 关键修改：使用正确的管道名称 'scan_codebase'
          pipelines: scan_codebase
          output-formats: html, json
          outputs-archive-name: scan-results
          project-name: FileServerClient

      - name: Upload Scan Report
        uses: actions/upload-artifact@v4
        with:
          name: license-scan-report
          path: outputs/
          retention-days: 5